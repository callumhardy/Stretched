"function"!=typeof Object.create&&(Object.create=function(t){function e(){}return e.prototype=t,new e}),Object.keys||(Object.keys=function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e}),function(t,e,i,n){$window=t(e);var a=$window.innerWidth(),r=$window.innerHeight(),g={backgroundSize:"cover",imageSelector:"img",alignX:"center",alignY:"center",stretcher:{padding:0},container:{padding:0},breakpoints:{},before:function(t){},after:function(t){}};t.fn.stretched=function(e){var i=t.extend({},g,e);return $containers=t(this),$containers.length>0&&$containers.each(function(){if($container=t(this),$images=$container.find(i.imageSelector),!($images.length<1)){var e={container:{},stretcher:{},image:{}};e.container.$=$container,$stretcher=t("<div>").addClass("stretcher"),$container.append($stretcher),e.stretcher.$=$stretcher,$images.each(function(){$image=t(this);var n=$image.attr("src");if($image.css({width:"auto",height:"auto",maxWidth:"none",maxHeight:"none",visibility:"hidden",position:"absolute"}),$stretcher.append($image),$image.attr("src",n),0===$image.width())$image.load(function(){e.image.$=t(this),e.image.naturalWidth=e.image.$.width(),e.image.naturalHeight=e.image.$.height(),e.image.ratio=e.image.naturalWidth/e.image.naturalHeight;var n=Object.create(o);n.init(i,e)});else{e.image.$=t(this),e.image.naturalWidth=e.image.$.width(),e.image.naturalHeight=e.image.$.height(),e.image.ratio=e.image.naturalWidth/e.image.naturalHeight;var a=Object.create(o);a.init(i,e)}})}}),$containers};var o={init:function(t,e){var i=this;i.config=t,i.originalConfig=t,i.elements=e,i.runStretch(),i.bindEvents()},runStretch:function(){var e=this,i=e.elements,n=e.config,a=!1,r=$window.innerWidth(),g=999999;$container=i.container.$,$stretcher=i.stretcher.$,$image=i.image.$,n.before(i),Object.keys(n.breakpoints).length>0&&t.each(n.breakpoints,function(e,i){e=parseInt(e,10),e>r&&g>e&&(g=e,n=t.extend({},n,i))}),$container.attr("style",""),"auto"===$container.css("z-index")&&$container.css({zIndex:0}),$stretcher.attr("style",""),$stretcher.css({zIndex:-1,overflow:"hidden",maxWidth:"",maxHeight:"",width:"auto",height:"auto"}),e.calculatePadding(i.stretcher,n.container.padding);var o=e.stretchToFill(i.stretcher,i.container);console.log("stretcher: "+o),"cover"===n.backgroundSize?(e.calculatePadding(i.image,0),e.stretchToCover(i.image,i.stretcher),e.imageAlignment()):(e.calculatePadding(i.image,n.stretcher.padding),e.stretchToContain(i.image,i.stretcher)),$image.css({visibility:"visible"}),"object"==typeof n.container&&t.each(n.container,function(t,e){"padding"!==t&&$container.css(t,e)}),"object"==typeof n.stretcher&&t.each(n.stretcher,function(t,e){"padding"!==t&&$stretcher.css(t,e)}),n.after(i)},bindEvents:function(){var t=this,e;return $window.resize(function(){clearTimeout(e),e=setTimeout(function(){t.runStretch()},50)}),t.elements.container.$.on("stretch",function(){t.runStretch()}),t},calculatePadding:function(e,i){var n=this;if($elem=e.$,$parent=$elem.parent(),e.padding={},i){"string"!=typeof i&&(i=i.toString());var a=i.split(" ");t.each(a,function(t,i){-1!==i.indexOf("%")?(i=parseFloat(i)/100,0===t?(e.padding.top=e.padding.bottom=$parent.height()*i,e.padding.right=e.padding.left=$parent.width()*i):1===t?e.padding.right=e.padding.left=$parent.width()*i:2===t?e.padding.bottom=$parent.height()*i:3===t&&(e.padding.left=$parent.width()*i)):(i=parseFloat(i),0===t?e.padding.top=e.padding.bottom=e.padding.right=e.padding.left=i:1===t?e.padding.right=e.padding.left=i:2===t?e.padding.bottom=i:3===t&&(e.padding.left=i))})}else e.padding.top=e.padding.right=e.padding.bottom=e.padding.left=0;return n},imageAlignment:function(){var t=this,e=t.elements,i=t.config;$container=e.container.$,$stretcher=e.stretcher.$,$image=e.image.$,"left"===i.alignX?$image.css({left:0,right:"",marginLeft:0}):"right"===i.alignX&&$image.css({left:"",right:0,marginLeft:0}),"top"===i.alignY?$image.css({top:0,bottom:"",marginTop:0}):"bottom"===i.alignY&&$image.css({top:"",bottom:0,marginTop:0})},stretchToContain:function(t,e){var i=this;$elem=t.$,$targetElem=e.$,e.ratio=$targetElem.width()/$targetElem.height(),e.innerWidth=e.$.innerWidth()-t.padding.right-t.padding.left,e.innerHeight=e.$.innerHeight()-t.padding.top-t.padding.bottom,e.innerRatio=e.innerWidth/e.innerHeight,t.ratio>e.innerRatio?(t.width=t.naturalWidth>e.innerWidth?e.innerWidth:t.naturalWidth,t.height=Math.ceil(t.width/t.ratio)):(t.height=t.naturalHeight>e.innerHeight?e.innerHeight:t.naturalHeight,t.width=Math.ceil(t.height*t.ratio)),t.marginLeft=-t.width/2+(t.padding.left/2-t.padding.right/2),t.marginTop=-t.height/2+(t.padding.top/2-t.padding.bottom/2),$elem.css({position:"absolute",top:"50%",left:"50%",marginLeft:t.marginLeft,marginTop:t.marginTop,width:t.width,height:t.height,maxWidth:"none",maxHeight:"none"})},stretchToCover:function(t,e){var i=this;$elem=t.$,$targetElem=e.$,e.ratio=$targetElem.width()/$targetElem.height(),t.ratio<e.ratio?(t.width=$targetElem.width()+1,t.height=Math.ceil(t.width/t.ratio)):(t.height=$targetElem.height()+1,t.width=Math.ceil(t.height*t.ratio)),t.marginLeft=-t.width/2,t.marginTop=-t.height/2,$elem.css({position:"absolute",top:"50%",left:"50%",marginLeft:t.marginLeft,marginTop:t.marginTop,width:t.width,height:t.height,maxWidth:"none",maxHeight:"none"})},stretchToFill:function(t,e){$elem=t.$,$targetElem=e.$,e.ratio=$targetElem.width()/$targetElem.height(),e.innerWidth=$targetElem.innerWidth()-t.padding.right-t.padding.left,e.innerHeight=$targetElem.innerHeight()-t.padding.top-t.padding.bottom,e.innerRatio=e.innerWidth/e.innerHeight,$elem.css({position:"absolute",top:t.padding.top,left:t.padding.left,width:e.innerWidth,height:e.innerHeight});var i=$targetElem.css("position");"absolute"!=i&&"relative"!=i&&$targetElem.css({position:"relative"})}}}(jQuery,window,document);